10 :REM'MAXUF - Max. Usable Frequencies - 17 JAN 2000
20 CLS:KEY OFF
30 IF EX$=""THEN EX$="EXIT"
40 COLOR 7,0,1
50 PI=4*ATN(1)  :REM'3.141593
60 RD=PI/180:D=180/PI
70 UL$=STRING$(80,205)
80 I$=STRING$(79,32)
90 D$=" ###.#°"
100 DIM AB(23),MF(23),FF(23),YF(23),FL(23),FU(23)
110 DIM FD(4),FI(4),FM(4)
120 DIM FR(8),YN(8),FY(8),YD(8),YC(8),FC(8),FE(8)
130 DIM M$(12)
140 DATA January,February,March,April,May,June
150 DATA July,August,September,October,November,December
160 FOR Z=1 TO 12:READ M$(Z):NEXT Z:RESTORE
170 :REM'
180 :REM'.....title page
190 CLS
200 COLOR 15,2
210 PRINT " MAXIMUM USABLE FREQUENCIES"TAB(57)"by George Murphy VE3ERP ";
220 COLOR 1,0:PRINT STRING$(80,223);
230 COLOR 7,0
240 PRINT " MAXIMUF 3.0 Program from Radio Netherlands, ";
250 PRINT "adapted by Robert R. Brown, NM7M,"
260 PRINT " from the original algorithm by Raymond Fricker."
270 PRINT UL$;
280 :REM'
290 :REM'.....clear variables
300 FOR Q=0 TO 23:AB(Q)=0:MF(Q)=0:NEXT Q
310 FOR Q=0 TO 4:FD(Q)=0:FI(Q)=0:FM(Q)=0:NEXT Q
320 FOR Q=0 TO 8:FR(Q)=0:FY(Q)=0:FY(Q)=0:YD(Q)=0:YC(Q)=0:FE(Q)=0:NEXT Q
330 AE=0:N=0:YT=0:XT=0:YR=0:XR=0:Q=0:U=0:HF=0:XQ=0
340 PL$="":T5$="":SR$="":SL=0:MU=0
350 R=0:M=0:X=0:Y=0:LA=0:LS=0:H=0:XS=0:XN=0:YI=0
360 SF=0:FE=0:SE=0:RE=0:CP=0:YN=0:YZ=0:XF=0:AX=0
370 K=0:HO=0:VE=0:L=0:XZ=0:MF=0:FF=0:RN=0:FD=0:TN=0
380 XH=0:SX=0:WX=0:LH=0:LM=0:AB=0:TD=0:FI=0:FW=0
390 TY=0:TL=0:MH=0:FO=0:YG=0:ZO=0:Z=0:XX=0:FQ=0
400 DU=0:HD=0:FL=0:FF=0
410 T$="":R$="":A$=""
420 :REM'
430 PRINT " This program calculates the M.U.F. (Maximum Usable Frequency) of";
440 PRINT " any short-   "
450 PRINT " wave sky wave path. Calculations can be done for any month and s";
460 PRINT "unspot number "
470 PRINT " between 1 and 200, or solar flux in the range of 64-300."
480 PRINT UL$;
490 COLOR 0,7:LOCATE ,23:PRINT " Press 1 to continue or 0 to EXIT ":COLOR 7,0
500 Z$=INKEY$:IF Z$=""THEN 500
510 IF Z$="1"THEN 550
520 IF Z$="0"THEN RUN EX$
530 GOTO 500
540 :REM'
550 VIEW PRINT 3 TO 24:CLS:VIEW PRINT:LOCATE 3
560 PRINT " ENTER: Name of Transmitter Location..........................? ";
570 LINE INPUT T$
580 LN=CSRLIN
590 INPUT " ENTER: Transmitter Latitude  (decimal °: + for N, - for S)...";XT
600 IF XT<-90 OR XT>90 THEN LOCATE LN:BEEP:PRINT I$:LOCATE LN:GOTO 590
610 LN=CSRLIN
620 INPUT " ENTER: Transmitter Longitude (decimal °: + for E, - for W)...";YT
630 YT=-YT
640 IF YT<-180 OR YT>180 THEN LOCATE LN:BEEP:PRINT I$:LOCATE LN:GOTO 620
650 PRINT " ENTER: Name of Receiver Location.............................? ";
660 LINE INPUT R$
670 LN=CSRLIN
680 INPUT " ENTER: Receiver Latitude  (decimal °: + for N, - for S)......";XR
690 IF XR<-90 OR XR>80 THEN LOCATE LN:BEEP:PRINT I$:LOCATE LN: GOTO 680
700 LN=CSRLIN
710 INPUT " ENTER: Receiver Longitude (decimal °: + for E, - for W)......";YR
720 YR=-YR
730 IF YR<-180 OR YR>180 THEN LOCATE LN:BEEP:PRINT I$:LOCATE LN:GOTO 710
740 LN=CSRLIN:COLOR 0,7
750 PRINT " Want M.U.F. based on sunspot (n)umber or 10.7cm solar (f)lux ? "
760 COLOR 7,0:PRINT " (Press n or f to select)"
770 Z$=INKEY$:IF Z$=""THEN 770
780 IF Z$="n"OR Z$="f"THEN VIEW PRINT LN TO 24:CLS:VIEW PRINT:LOCATE LN
790 IF Z$="n"THEN 870
800 IF Z$="f"THEN 830
810 GOTO 770
820 :REM'
830 INPUT " ENTER: Solar Flux.........";FL
840 R=(-0.7300000190734863!+SQR(0.7300000190734863!^2-4*(0.0008999999845400453!)*(63.70000076293945!-FL)))/(0.0017999999690800905!)
850 GOTO 900
860 :REM'
870 INPUT " ENTER: Sunspot Number.....";R
880 FL=63.70000076293945!+0.7300000190734863!*R+(0.0008999999845400453!)*R^2
890 :REM'
900 LN=CSRLIN
910 INPUT " ENTER: Month Number.......";M
920 IF M<1 OR M>12 THEN LOCATE LN:BEEP:PRINT I$:LOCATE LN:GOTO 910
930 :REM'
940 :REM'.....muf geometry
950 Q=SIN(XT*RD)*SIN(XR*RD)
960 X=Q+COS(XT*RD)*COS(XR*RD)*COS(YT*RD-YR*RD)
970 LA=-ATN(X/SQR(-X*X+1+9.999999960041972e-13!))+(PI/2): LA=LA*D
980 L=111.0999984741211!*LA
990 Q=SIN(XR*RD)-SIN(XT*RD)*COS(LA*RD)
1000 X=Q/COS(XT*RD)/SIN(LA*RD)
1010 U=-ATN(X/SQR(-X*X+1+9.999999960041972e-13!))+(PI/2): U=U*D
1020 IF YT-YR<=0 THEN U=360-U
1030 IF ABS(YT-YR)>=180 THEN U=360-U
1040 H=275+R/2
1050 XS=23.399999618530273!*COS(30*(M-6.25!)*RD)
1060 N=N+1
1070 LH=L/N
1080 IF LH>4500 THEN 1060
1090 LM=LA/N
1100 X=COS(0.5!*LM*RD)
1110 AE=ATN((X-6367/(H+6367))/SIN(0.5!*LM*RD))
1120 AE=AE*D:    :REM'elevation angle calculation
1130 IF AE<1.5! THEN 1060
1140 :REM'
1150 VIEW PRINT 3 TO 24:CLS:VIEW PRINT:LOCATE 3
1160 IF XT<0 THEN LA$="S":ELSE LA$="N"
1170 IF YT<0 THEN LO$="E":ELSE LO$="W"
1180 PRINT " FROM: ";T$+",";USING D$+LA$;ABS(XT);:PRINT USING D$+LO$;ABS(YT);
1190 LOCATE ,40
1200 IF XR<0 THEN LA$="S":ELSE LA$="N"
1210 IF YR<0 THEN LO$="E":ELSE LO$="W"
1220 PRINT "│ TO: ";R$+", ";USING D$+LA$;ABS(XR);:PRINT USING D$+LO$;ABS(YR)
1230 PRINT UL$;:LOCATE CSRLIN-1
1240 LOCATE ,26:PRINT "╤";:LOCATE ,40:PRINT "╧";:LOCATE ,54:PRINT "╤"
1250 PRINT TAB(2)"Month: ";M$(M);TAB(26)"│ Distance:";USING "##,### km";L;
1260 PRINT TAB(54)"│ ƒ-hops:";N
1270 PRINT TAB(2)"Radiation Angle:";USING "###.#° ";AE;
1280 PRINT TAB(26)"│ Sunspot #:";USING "####.#";R;
1290 PRINT TAB(54)"│ Solar Flux:";USING "####.#";FL
1300 PRINT UL$;:LOCATE CSRLIN-1
1310 LOCATE ,26:PRINT "╧";:LOCATE ,40:PRINT "╤";:LOCATE ,54:PRINT "╧"
1320 H$=" UTC   ƒ(90%)MHz  ƒ(50%)MHz  ƒ(10%)MHz"
1330 PRINT H$;" │";TAB(42)H$
1340   FOR TD=0 TO 23
1350 K=0.5!:GOSUB 1700:PP=XN:QQ=YN:GOSUB 1840:MFA=FF:XFA=XF
1360 K=N-0.5!:GOSUB 1700:RR=XN:SS=YN:GOSUB 1840:MFB=FF:XFB=XF
1370 IF MFA<MFB THEN 1380 :ELSE 1390
1380 MF(TD)=MFA:XY=XFA:GOTO 1400
1390 MF(TD)=MFB:XY=XFA:GOTO 1400
1400 FL(TD)=MF(TD)/(1.1299999952316284!+XY/1800):FU(TD)=MF(TD)/(0.8700000047683716!-XY/1800)
1410 U$="#########.#"
1420 TD$=RIGHT$(STR$(TD*100),LEN(STR$(TD*100))-1)
1430 IF LEN(TD$)<4 THEN TD$="0"+TD$
1440 IF LEN(TD$)<4 THEN TD$="0"+TD$:GOTO 1440
1450 :REM'
1460 IF TD<12 THEN LOCATE TD+9,2 :ELSE LOCATE TD-3,40  :REM'format columns
1470 :REM'
1480 IF TD>=12 THEN PRINT "│ ";
1490 PRINT TD$;:PRINT USING U$;FL(TD),MF(TD),FU(TD);
1500 IF TD=23 THEN PRINT ""
1510 NEXT TD
1520 IF PP<0 THEN LA$="S":ELSE LA$="N"
1530 IF QQ<0 THEN LO$="E":ELSE LO$="W"
1540 PRINT "  Control Point #1:";
1550 PRINT USING D$+LA$;ABS(PP);:PRINT USING D$+LO$;ABS(QQ);
1560 LOCATE ,41
1570 IF RR<0 THEN L$="S":ELSE LA$="N"
1580 IF SS<0 THEN LO$="E":ELSE LO$="W"
1590 PRINT "  Control Point #2:";
1600 PRINT USING D$+LA$;ABS(RR);:PRINT USING D$+LO$;ABS(SS);
1610 LN=CSRLIN+1:GOSUB 3570:LOCATE 25,1:PRINT I$;:LOCATE LN,21
1620 COLOR 0,7:PRINT " Run again with one more hop?  (y/n) ":COLOR 7,0
1630 Z$=INKEY$:IF Z$=""THEN 1630
1640 IF Z$="y"THEN 1060
1650 IF Z$="n"THEN 180
1660 GOTO 1630
1670 END
1680 :REM'
1690 :REM'.....mufil
1700 :REM'.....intermediate latitude and longitude
1710 Q=COS(U*RD)*COS(XT*RD)*SIN(K*LM*RD)
1720 X=Q+SIN(XT*RD)*COS(K*LM*RD)
1730 XN=ATN(X/SQR(-X*X+1+9.999999960041972e-13!)): XN=XN*D: REM Int Lat in deg
1740 Q=(COS(K*LM*RD)-SIN(XT*RD)*SIN(XN*RD))
1750 X=Q/(COS(XT*RD)*COS(XN*RD))
1760 YI=-ATN(X/SQR(-X*X+1+9.999999960041972e-13!))+(PI/2): YI=YI*D: REM Long Diff in deg
1770 IF U<180 THEN YI=-YI
1780 YN=YT+YI: :REM'Int Long in deg
1790 IF YN>180 THEN YN=YN-360
1800 IF YN<-180 THEN YN=YN+360
1810 RETURN
1820 :REM'
1830 :REM'..... muff2l
1840 :REM'.... F-2 Layer calculation
1850 REM
1860 YZ=YN
1870 IF YN<-160 THEN YZ=YN+360
1880 YG=(20-YZ)/50
1890 ZO=20*YG/(1+YG+YG^2)+5*(1-YG/7)^2
1900 Z=XN-ZO: REM magnetic dip equator correction for xn
1910 TL=TD-YN/15: REM local time at xn, yn
1920 IF TL>24 THEN TL=TL-24
1930 IF TL<0 THEN TL=TL+24
1940 AX=1-0.03400000184774399!*COS(30*(M-6.25!)*RD): REM Annual Variation
1950 MH=M
1960 IF Z>0 THEN 1990
1970 Z=-Z
1980 MH=M+6
1990 XH=COS(30*(MH-6.5!)*RD): REM 1 Week Delay on Equinoxes
2000 SX=(ABS(XH)+XH)/2: REM F-Layer Local Summer Variation
2010 WX=(ABS(XH)-XH)/2: REM F-Layer Local Winter Variation
2020 IF Z<77.5! THEN 2070
2030 X=(3.299999952316284!+SX*0.800000011920929!-WX*0.699999988079071!)
2040 Q=(1+R/(180+SX*260-WX*45))
2050 FO=AX*((X*Q)+(Z-75)*(1-SX)/(60-WX*35+R*(1-WX*4/5)))+0.5199999809265137!
2060 GOTO 3320
2070 TY=TL
2080 IF TY<5 THEN TY=TL+24
2090 TN=TL
2100 IF TN<15+SX-WX*3 THEN TN=TL+24
2110 Q=(TY-14-SX*2+WX*2-R/(200-SX*50-WX*50))
2120 YF(1)=Q*(7-SX*3+WX*4-R/(150-WX*75))
2130 IF ABS(YF(1))>60 THEN YF(1)=60
2140 X=(6.5!-WX*0.5!)*(1+R/(170+SX*200+WX*15))
2150 FF(1)=X*COS(YF(1)*RD)*COS((Z-SX*5+WX*5)*RD)^0.5!
2160 YA=(TY-8.5!-R*SX/125)*(30-R*SX/30)
2170 IF ABS(YA)>89 THEN YA=89
2180 X=(2.299999952316284!-SX*1.100000023841858!+WX*0.20000000298023224!)
2190 Q=(1+R/(400-SX*320-WX*225))
2200 FA=X*Q*COS(YA*RD)*COS((Z-4+SX*4-WX-R*WX/30)*RD)^24
2210 X=(TY-14.5!+SX*1.2999999523162842!+WX*0.20000000298023224!+R/(75+SX*25+WX*100))
2220 YB=X*(18+SX*8-WX-R*(1-WX*4)/(150-SX*138))
2230 IF ABS(YB)>89 THEN YB=89
2240 X=(4.599999904632568!-SX*2.5999999046325684!-WX*1.2999999523162842!)*(1-R*(1-SX-WX*7/5)/600)
2250 FB=X*COS(YB*RD)*COS((Z-15+WX*3-R*(SX/12+WX/150))*RD)^48
2260 X=(TY-19+SX*2.200000047683716!+WX*0.20000000298023224!-R*(1-SX*5/3)/(100+WX*10))
2270 YC=X*(18+SX*8-WX-R/(50-SX*35+WX*100))
2280 IF ABS(YC)>89 THEN YC=89
2290 X=(3.299999952316284!-SX*0.20000000298023224!+WX*0.800000011920929!)*(1+R/(290-SX*15-WX*130))
2300 Q=X*COS(YC*RD)
2310 FC=Q*COS((Z-3-SX*10-R*(1-SX*6/5)/(15+WX*5))*RD)^48
2320 X=(TY-24+SX*0.30000001192092896!-WX*0.20000000298023224!-R*(1-SX*2)/(200-WX*100))
2330 YD=X*(26+WX*10-R/(75-SX*35-WX*57))
2340 IF ABS(YD)>89 THEN YD=89
2350 X=(2.5999999046325684!-SX*4.699999809265137!-WX*1.600000023841858!)*(1+R*(1-SX*17/5)/(180-WX*130))
2360 Q=X*COS(YD*RD)
2370 FD=Q*COS((Z-3-SX*4-WX-R/(75-SX*50-WX*15))*RD)^64
2380 Q=(1-SX*7/3-WX*2)
2390 YF(3)=(TN-28.899999618530273!+SX*0.20000000298023224!+WX*0.20000000298023224!-R*Q/600)*(36+WX*9+R*SX/25)
2400 IF ABS(YF(3))>89 THEN YF(3)=89
2410 X=-(1.2999999523162842!+SX*1.100000023841858!+WX*0.20000000298023224!)*(1-R/(170+SX*130+WX*1490))
2420 Q=X*COS(YF(3)*RD)
2430 FF(3)=Q*COS((Z-8+SX*6-WX*2-R*(1-SX*2)/(75-WX*65))*RD)^16
2440 X=(TN-26.5!-SX*1.5!+WX*3.5!-R*WX/75)
2450 YF(4)=X*(7-SX*0.5!-WX*2+R*(1-SX)/(50+WX*10))
2460 IF ABS(YF(4))>89 THEN YF(4)=89
2470 X=(1.2999999523162842!+SX*0.10000000149011612!-WX*0.10000000149011612!)*(1+R*(1-SX*4/3)/(170-WX*85))
2480 FF(4)=X*COS(YF(4)*RD)*SIN((Z+13+SX*2-WX*2)*RD)^64
2490 YF(5)=(TY-12)*13
2500 IF ABS(YF(5))>89 THEN YF(5)=89
2510 Q=0.800000011920929!*(1-SX-WX)*(1+R/70)
2520 FF(5)=Q*COS(YF(5)*RD)*COS((Z-25-R/15)*RD)^24
2530 YF(6)=(TN-23-R/100)*(20+R/75)
2540 IF ABS(YF(6))>89 THEN YF(6)=89
2550 FF(6)=R*(1-SX-WX)/60*COS(YF(6)*RD)*COS((Z-18)*RD)^48
2560 YF(7)=(TN-26)*36
2570 IF ABS(YF(7))>89 THEN YF(7)=89
2580 FF(7)=-SX*1.2999999523162842!*(1-R/150)*COS(YF(7)*RD)*COS(Z*RD)^64
2590 YF(8)=(TY-13+R/300)*(15+R/75)
2600 IF ABS(YF(8))>89 THEN YF(8)=89
2610 FF(8)=R*WX/33*COS(YF(8)*RD)*COS((Z-52)*RD)^16
2620 Q=FF(1)+FA+FB+FC+FD+FF(3)
2630 FO(1)=Q+FF(4)+FF(5)+FF(6)+FF(7)+FF(8)
2640 Q=(TY-10.5!+WX*1.5!+R*(1-WX*2)/300)
2650 YF(9)=Q*(60-WX*24-R/(10+WX*20))
2660 IF ABS(YF(9))>89 THEN YF(9)=89
2670 X=(-R*(1-SX)/150+WX*0.800000011920929!*(1+R/175))
2680 Q=X*COS(YF(9)*RD)
2690 FF(9)=Q*COS((Z-20-WX*2+R*(1-WX*33/13)/20)*RD)^48
2700 YF(10)=(TY-15)*(18-R/75)
2710 IF ABS(YF(10))>89 THEN YF(10)=89
2720 Q=-SX*0.800000011920929!*(1-R/600)
2730 FF(10)=Q*COS(YF(10)*RD)*COS((Z-47-R/40)*RD)^48
2740 YF(11)=(TY-18.5!-WX*0.5!-R*WX/150)*(30+WX*15)
2750 IF ABS(YF(11))>89 THEN YF(11)=89
2760 X=(SX*0.5!*(1+R/300)+WX*R/250)
2770 Q=X*COS(YF(11)*RD)
2780 FF(11)=Q*COS((Z-27+WX*7+R*(1-WX*11/6)/25)*RD)^48
2790 YF(12)=(TY-20+WX-R*(1-WX*2)/100)*(45-R*(1-WX)/15)
2800 IF ABS(YF(12))>89 THEN YF(12)=89
2810 Q=-R*(1-SX-WX*2)
2820 FF(12)=Q/160*COS(YF(12)*RD)*COS((Z-45+WX*3)*RD)^48
2830 YF(13)=(TY-20.5!)*22
2840 IF ABS(YF(13))>89 THEN YF(13)=89
2850 Q=-R*(1-SX-WX)
2860 FF(13)=Q/150*COS(YF(13)*RD)*COS((Z-6+R/17)*RD)^64
2870 YF(14)=(TY-22-WX+R/150)*(45-WX*27+R*WX/10)
2880 IF ABS(YF(14))>89 THEN YF(14)=89
2890 X=-0.4000000059604645!*(1-SX+WX/4)*(1-R/(48-WX*18))
2900 Q=X*COS(YF(14)*RD)
2910 FF(14)=Q*COS((Z-15-WX*5+R/(25-WX*10))*RD)^64
2920 YF(15)=(TY-22-WX*2-R*(1-WX)/75)*(20+R*(1-WX)/30)
2930 IF ABS(YF(15))>89 THEN YF(15)=89
2940 Q=(-SX*0.6000000238418579!+WX*R/100)
2950 FF(15)=Q*COS(YF(15)*RD)*COS((Z-70+WX*5)*RD)^64
2960 Q=(TN-24-SX*1.5!-R*(1-SX*2)/75)
2970 YF(16)=Q*(30-SX*8-R*(1+SX*7/5)/30)
2980 IF ABS(YF(16))>89 THEN YF(16)=89
2990 X=0.30000001192092896!*(1-SX*13/3-WX)*(1+R*(1-SX*8/5)/150)
3000 FF(16)=X*COS(YF(16)*RD)*COS((Z-32-SX*6-R*SX/15)*RD)^48
3010 YF(17)=(TN-26.5!+R/150)*(22+R/15)
3020 IF ABS(YF(17))>89 THEN YF(17)=89
3030 Q=-0.5!*(1-SX-WX)*(1-R/65)
3040 FF(17)=Q*COS(YF(17)*RD)*COS((Z-55-R/75)*RD)^48
3050 Q=FF(9)+FF(10)+FF(11)+FF(12)
3060 FO(2)=Q+FF(13)+FF(14)+FF(15)+FF(16)+FF(17)
3070 IF WX=0 THEN 3310
3080 YF(18)=(TY-8.5!)*45
3090 IF ABS(YF(18))>89 THEN YF(18)=89
3100 Q=-0.4000000059604645!*(1+R/250)
3110 FF(18)=Q*COS(YF(18)*RD)*COS((Z-60+R/30)*RD)^64
3120 YF(19)=(TY-9.5!)*(20+R/15)
3130 IF ABS(YF(19))>89 THEN YF(19)=89
3140 FF(19)=-0.5!*(1+R/150)*COS(YF(19)*RD)*COS((Z-68)*RD)^64
3150 YF(20)=(TY-15-R/35)*(22-R/50)
3160 IF ABS(YF(20))>89 THEN YF(20)=89
3170 Q=0.6000000238418579!*(1+R/175)*COS(YF(20)*RD)
3180 FF(20)=Q*COS((Z-27-R/50)*RD)^64
3190 YF(21)=(TY-17.5!-R/100)*45
3200 IF ABS(YF(21))>89 THEN YF(21)=89
3210 FF(21)=0.20000000298023224!*(1+R/75)*COS(YF(21)*RD)*COS((Z-70)*RD)^64
3220 YF(22)=(TY-19-R/75)*(20+R/75)
3230 IF ABS(YF(22))>89 THEN YF(22)=89
3240 Q=-0.699999988079071!*(1+R/450)
3250 FF(22)=Q*COS(YF(22)*RD)*COS((Z-52+R/15)*RD)^24
3260 YF(23)=(TN-29)*45
3270 IF ABS(YF(23))>89 THEN YF(23)=89
3280 Q=-0.6000000238418579!*(1+R/300)
3290 FF(23)=Q*COS(YF(23)*RD)*COS((Z-57+R/15)*RD)^48
3300 FO(3)=FF(18)+FF(19)+FF(20)+FF(21)+FF(22)+FF(23)
3310 FO=AX*(FO(1)+FO(2)+WX*FO(3))+0.5199999809265137!
3320 HF=H
3330 IF Z>5 THEN 3380
3340 HF=H+50
3350 IF TL>2 AND TL<9 THEN HF=H+25
3360 IF TL>4 AND TL<7 THEN HF=H
3370 GOTO 3460
3380 IF Z>10 THEN 3430
3390 HF=H+25+25*SX
3400 IF TL>2 AND TL<9 THEN HF=H+25*SX
3410 IF TL>4 AND TL<7 THEN HF=H
3420 GOTO 3460
3430 IF Z<20 OR Z>60 THEN 3460
3440 IF TL>8 AND TL<16 THEN HF=H+SX*50-WX*25
3450 IF TL>23 OR TL<3 THEN HF=H+WX*50
3460 SF=(1-(COS(AE*RD)*6367/(6367+HF))^2)^(-0.5!)
3470 Q=SIN(XN*RD)*SIN(XS*RD)
3480 X=Q+COS(XN*RD)*COS(XS*RD)*COS((YN-15*(TD-12))*RD)
3490 IF X=1 THEN X=1-9.999999717180685e-10!
3500 XF=-ATN(X/SQR(-X*X+1))+(PI/2): XF=XF*D
3510 FF=(FO*SF)
3520 RETURN
3530 :REM'
3540 :REM'.....END
3550 GOSUB 3570:GOTO 180
3560 :REM'
3570 :REM'PRT
3580 KEY OFF:GOSUB 3650:LOCATE 25,5:COLOR 0,2
3590 PRINT " Send this page to:(1)Printer Queue? (2)Printout? ";
3600 PRINT "(3)Next page? (1/2/3)";:COLOR 7,0
3610 Z$=INKEY$:IF Z$<"1"OR Z$>"3"THEN 3610 :ELSE GOSUB 3650
3620 IF Z$="3"THEN RETURN
3630 FOR I%=1 TO 24:FOR J%=1 TO 80:LPRINT CHR$(SCREEN(I%,J%));:NEXT J%:NEXT I%
3640 IF Z$="2"THEN LPRINT CHR$(12) :ELSE 3580
3650 LOCATE 25,1:PRINT STRING$(80,32);:RETURN
