10 :REM'PSUPERF - Power Supply Performance  - 17 September 2005
20 CLS:KEY OFF
30 IF EX$=""THEN EX$="EXIT"
40 IF PROG$=""THEN GO$=EX$ :ELSE GO$=PROG$
50 COMMON EX$,PROG$
60 DIM X(22),Y(22),VR(22),RF(22),RMS(22),PK(22)
70 :REM'.....title page
80 C=0:VPRI=0:RPRI=0:VSEC=0:RSEC=0 :DEF FNL(X)=LOG(X)/LOG(10)
90 CLS
100 COLOR 15,2,1
110 PRINT " Power Supply Performance"TAB(60)"by Robert J. Dehoney ";
120 COLOR 1,0:PRINT STRING$(80,223);
130 COLOR 7,0
140 :REM'
150 T=7
160 PRINT TAB(T);
170 PRINT "This program helps design half wave, full wave, bridge, and doubler"
180 PRINT TAB(T);
190 PRINT "power supplies using on-hand power transformers. It is based on "
200 PRINT TAB(T);
210 PRINT "equations derived from accurate time step simulations."
220 PRINT TAB(T);
230 PRINT "Required inputs are the frequency of operation, the primary and"
240 PRINT TAB(T);
250 PRINT "no-load leg-to-leg secondary AC voltages, and the DC resistances"
260 PRINT TAB(T);
270 PRINT "of both the primary and secondary windings. In addition, you will"
280 PRINT TAB(T)
290 PRINT "be asked to enter a value for the filter capacitor. You can"
300 PRINT TAB(T)
310 PRINT "estimate its value as C=350/F*I/Vpp uF, where Vpp is the peak to"
320 PRINT TAB(T)
330 PRINT "peak ripple, F is the freq in Hz and I is the load current in mA."
340 PRINT
350 COLOR 0,7:LOCATE ,23:PRINT " Press 1 to continue or 0 to EXIT "
360 COLOR 7,0
370 Z$=INKEY$:IF Z$=""THEN 370
380 IF Z$="0"THEN CHAIN GO$
390 IF Z$="1"THEN CLS:GOTO 410
400 GOTO 370
410 :REM'
420 COLOR 7,0,0
430 IF F*VPRI*RPRI*VSEC*RSEC THEN 500
440 INPUT "ENTER: A.C. Frequency (Hz) ";F :IF F=0 THEN 440
450 INPUT "ENTER: AC line voltage";VPRI :IF VPRI=0 THEN 450
460 INPUT "ENTER: Primary winding resistance (ohms)";RPRI
470 PRINT "ENTER: Secondary leg-to-leg no-load AC voltage at";VPRI;"volts";
480 INPUT VSEC :IF VSEC=0 THEN 470
490 INPUT "ENTER: Secondary leg-to-leg winding resistance (ohms)";RSEC
500 PRINT
510 PRINT "Choose the type of supply:"
520 PRINT "         1) Half Wave"
530 PRINT "         2) Full Wave "
540 PRINT "         3) Bridge"
550 PRINT "         4) Floating Doubler"
560 PRINT "         5) Grounded Doubler"
570 PRINT
580 :REM'
590 INPUT "Enter number 1, 2, 3, 4, or 5 ";NT
600 IF NT<1 OR NT>5 THEN 590 :ELSE PRINT
610 HW=1-(NT=1) :FW=1-(NT=2) :BR=1-(NT=3) :DBLR1=1-(NT=4) :DBLR2=1-(NT=5)
620 RST=RSEC/FW+(VSEC/FW/VPRI)^2*RPRI :VD=0.699999988079071!
630 VPK=SQR(2)*VSEC/FW-VD*BR
640 CLS:ONNT GOSUB 4710,4790,4860,4940,5020 :REM'print schematic
650 :REM'
660 LOCATE 18,41:PRINT "Enter a value (10<C<32000) for C, uF"
670 LOCATE 19,41:PRINT "-or- Enter 1 to re-run w/same xfmr."
680 LOCATE 20,41:PRINT "-or- Enter 2 to return to start menu"
690 IF C=0 THEN 760
700 LOCATE 25:COLOR  0,2:PRINT " Want a hard copy printout ?";
710 COLOR 16,2:PRINT "   (y/n)  ";:COLOR 7,0
720 Z$=INKEY$:IF Z$=""THEN 720
730 IF Z$="n"THEN GOSUB 5240:GOTO 760 :REM'clear part of screen
740 IF Z$="y"THEN GOSUB 5110:GOTO 660 :REM'hard copy
750 GOTO 720
760 LOCATE 21,41:INPUT C :IF C=0 THEN 760
770 IF C<3 OR (C>10 AND C<32000) THEN 790
780 BEEP:LOCATE 21,41:PRINT "        ":GOTO 760
790 IF C=1 THEN C=0 :CLS :GOTO 510
800 IF C=2 THEN 70 :ELSE C=C*9.999999974752427e-07!:CLS
810 ONNT GOSUB 830,840,850,860,870
820 PRINT "                    ";A$ :GOTO 880
830 A$="Half Wave Rectifier." :B$="v" :RETURN
840 A$="Full Wave Rectifier.":B$="vct" :RETURN
850 A$="Bridge Rectifier" :B$="v" :RETURN
860 A$="Floating Doubler" :B$="v" :RETURN
870 A$="Grounded Doubler" :B$="v" :RETURN
880 PRINT "Vpri="VPRI"v   Vsec="VSEC;B$;
890 PRINT "   C="CINT(C*1000000.0!)"uF   Surge current="INT(10*VPK/RST)/10"amps"
900 LOCATE ,46:PRINT " Transformer     Diode    "
910 :REM'LOCATE ,46:PRINT "┌───── Diode Data ──────┐"
920 PRINT " RL        Vdc          Idc       P-P ripple      Irms        Ipeak "
930 READ RL :IF RL=0 THEN RESTORE :PRINT TAB(51);"Diode PIV=";INT(PIV*100)/100 :    ONNT GOSUB 4710,4790,4860,4940,5020 :REM'print schematic
940 :REM'
950 :REM'.......define X(P)=values of WRCR
960 X(1)=1000 :X(2)=700 :X(3)=400 :X(4)=300 :X(5)=200 :X(6)=100 :X(7)=70
970 X(8)=40 :X(9)=30 :X(10)=20 :X(11)=10 :X(12)=7 :X(13)=4 :X(14)=3 :X(15)=2
980 X(16)=1 :X(17)=0.699999988079071! :X(18)=0.4000000059604645! :X(19)=0.30000001192092896! :X(20)=0.20000000298023224! :X(21)=0.10000000149011612!
990 :REM'
1000 WCRL=6.283199787139893!*F*C*RL :IF WCRL<0.10000000149011612! THEN 930 :REM'curve limit
1010 IF WCRL>1000 THEN WCRL=1000 :REM'curve limit
1020 KR=100*RST/RL :IF KR<0.019999999552965164! THEN KR=0.019999999552965164! :ELSE IF KR>100 THEN 930 :REM'curve limit
1030 X=KR :ONNT GOSUB 1170,2060,2060,2940,3820 :REM'calculate VR,RF,RMS,& PK
1040 X=WCRL :GOSUB 1110 :REM'interpolate to get final values for VR,RF,RMS, & PK
1050 :REM'......calculate Vdc, Idc, Vpp, Irms, & Ipk
1060  VDC=VR*VPK/100 :IDC=VDC/RL :VRIP=RF*VDC/100 :IRMS=RMS*IDC :IPK=PK*IDC
1070 PIV=2*VPK/BR :REM'Calculate peak inverse voltage
1080 PRINT RL;TAB(9) USING "###.###      ";VDC;IDC;VRIP;IRMS;IPK
1090 GOTO 930
1100 DATA 1500,1000,500,200,100,75,50,20,15,10,0
1110 :REM'..........Interpolation subroutine
1120 FOR P=1 TO 20 :IF X=<X(P) THEN P1=P
1130 NEXT P :X1=X(P1) :X2=X(P1+1) :Y1=VR(P1) :Y2=VR(P1+1) :GOSUB 4700 :VR=Y
1140 Y1=RF(P1): Y2=RF(P1+1) :GOSUB 4700 :RF=Y
1150 Y1=RMS(P1) :Y2=RMS(P1+1) :GOSUB 4700 :RMS=Y
1160 Y1=PK(P1):Y2=PK(P1+1) :GOSUB 4700 :PK=Y :RETURN
1170 :REM'............calculate half wave values for given KR
1180 :REM'.......Halfwave VR
1190 Z=FNL(X+0.3100000023841858!):VR(1)=91.56107792#-15.5081795#*Z-7.12938731#*Z^2-7.70040283#*Z^3+3.19263506#*Z^4
1200 Z=FNL(X+0.4000000059604645!):VR(2)=92.18267369#-16.7859453#*Z-5.26133924#*Z^2-9.0418276#*Z^3+3.51925202#*Z^4
1210 VR(3)=92.17591094970703!-16.6628225#*Z-5.59237461#*Z^2-8.768989659999999#*Z^3+3.45031001#*Z^4
1220 Z=FNL(X+0.44999998807907104!):VR(4)=92.53907245#-17.3002784#*Z-4.90195835#*Z^2-9.18317749#*Z^3+3.54245753#*Z^4
1230 Z=FNL(X+0.699999988079071!):VR(5)=94.61447411#-21.2485896#*Z-0.66526227#*Z^2-11.5872606#*Z^3+4.0522822#*Z^4
1240 Z=FNL(X+1.2000000476837158!):VR(6)=98.80125959#-26.7908547#*Z+2.01843768#*Z^2-12.0467207#*Z^3+4.04621601#*Z^4
1250 Z=FNL(X+2):VR(7)=106.2262415#-35.9476287#*Z+5.35999662#*Z^2-11.9815182#*Z^3+3.86589157#*Z^4
1260 Z=FNL(X+0.4000000059604645!):VR(8)=90.21400881#-10.8836695#*Z-13.3457575#*Z^2-4.05586146#*Z^3+2.42951057#*Z^4
1270 Z=FNL(X+0.44999998807907104!):VR(9)=89.13193794#-8.86667792#*Z-14.1173284#*Z^2-4.39445323#*Z^3+2.6087141799999998#*Z^4
1280 Z=FNL(X+1.340000033378601!):VR(10)=86.615#+8.82092801#*Z-39.1646588#*Z^2+9.24812627#*Z^3
1290 Z=FNL(X+2.700000047683716!):VR(11)=68.93244#+47.11282097#*Z-65.14229710000001#*Z^2+14.898953#*Z^3
1300 Z=FNL(X+4.300000190734863!):VR(12)=48.79010009765625!+85.4806082#*Z-88.48060822#*Z^2+19.53125921#*Z^3
1310 Z=FNL(X+8.5!):VR(13)=1.30592#+160.1241853#*Z-126.740587#*Z^2+25.9403519#*Z^3
1320 Z=FNL(X+14):VR(14)=-50.708305#+245.82859150000002#*Z-172.43580627441406!*Z^2+33.91363273#*Z^3
1330 VR(15)=47.74396521#-0.51722535#*X+0.002935329917818308!*X^2-5.689999852620531e-06!*X^3
1340 VR(16)=37.77974793#-0.37661643#*X+0.002628709888085723!*X^2-8.660000275995117e-06!*X^3
1350 VR(17)=34.89924826#-0.34408706#*X+0.0025494699366390705!*X^2-9.069999578059651e-06!*X^3
1360 VR(18)=32.65021309#-0.31992775#*X+0.002465049969032407!*X^2-9.1499996415223e-06!*X^3
1370 VR(19)=32.19605758#-0.31519176#*X+0.002445769961923361!*X^2-9.139999747276306e-06!*X^3
1380 VR(20)=31.74190226#-0.31045575999999997#*X+0.002426489954814315!*X^2-9.129999853030313e-06!*X^3
1390 VR(21)=31.50593368#-0.30788059#*X+0.0024119000881910324!*X^2-9.09000027604634e-06!*X^3
1400 :REM'.........halfwave RF
1410 Z=FNL(X+0.03099999949336052!):RF(1)=0.54146109#-0.06733129173517227!*Z-0.012637569569051266!*Z^2+0.0028842000756412745!*Z^3
1420 Z=FNL(X+0.035999998450279236!):RF(2)=0.7736689999999999#-0.09673070907592773!*Z-0.012809944#*Z^2+0.004204949829727411!*Z^3
1430 Z=FNL(X+0.054999999701976776!):RF(3)=1.3563319444656372!-0.17322519#*Z-0.031246259808540344!*Z^2+0.006796676199883223!*Z^3
1440 Z=FNL(X+0.05299999937415123!):RF(4)=1.8086680173873901!-0.22995978#*Z-0.04334414005279541!*Z^2+0.011191749945282936!*Z^3
1450 Z=FNL(X+0.04699999839067459!):RF(5)=2.71223#-0.34174456#*Z-0.06976933032274246!*Z^2+0.018510689958930016!*Z^3
1460 Z=FNL(X+0.0689999982714653!):RF(6)=5.43176699#-0.6733986139297485!*Z-0.15879907#*Z^2+0.0470203198492527!*Z^3
1470 Z=FNL(X+0.12200000137090683!):RF(7)=7.7873262#-0.97554464#*Z-0.27985203000000003#*Z^2+0.08992710709571838!*Z^3
1480 Z=FNL(X+0.1899999976158142!):RF(8)=13.62676813#-1.58067372#*Z-0.67717427#*Z^2+0.22088452#*Z^3
1490 Z=FNL(X+0.30000001192092896!):RF(9)=18.1741213#-1.9612967000000001#*Z-1.11688045#*Z^2+0.36517821#*Z^3
1500 Z=FNL(X+0.4000000059604645!):RF(10)=27.0186648#-2.32205758#*Z-2.19408535#*Z^2+0.68145965#*Z^3
1510 Z=FNL(X+1):RF(11)=51.98220027#-0.37967639#*Z-7.48581398#*Z^2+2.08315358#*Z^3
1520 Z=FNL(1.7000000476837158!):RF(12)=70.7837771#+5.02903323#*Z-13.9150278#*Z^2+5.58747517#*Z^3
1530 Z=FNL(X+4.199999809265137!):RF(13)=103.48719787597656!+38.05073757#*Z-40.3896181#*Z^2+9.23284598#*Z^3
1540 Z=FNL(X+6.599999904632568!):RF(14)=114.28#+78.64570866#*Z-66.5580687#*Z^2+14.22434404#*Z^3
1550 RF(15)=187.0100151#-0.36271601#*X+0.001032860018312931!*X^2+3.980000201408984e-06!*X^3
1560 RF(16)=259.0211792#-0.06485249847173691!*X-0.0023272898979485035!*X^2+1.7250000382773578e-05!*X^3
1570 RF(17)=283.476878#-0.02242939919233322!*X-0.001529959961771965!*X^2+1.0009999641624745e-05!*X^3
1580 RF(18)=303.7650146484375!-0.028839999809861183!*X
1590 RF(19)=308.1184997558594!-0.018279999494552612!*X
1600 RF(20)=312.47198486328125!-0.007720000110566616!*X
1610 RF(21)=314.70001220703125!
1620 :REM'.......halfwave RMS
1630 Z=FNL(X-0.0008999999845400453!):RMS(1)=2.9226520000000002#-1.06691542#*Z+0.24371209740638733!*Z^2-0.010850749909877777!*Z^3
1640 Z=FNL(X-0.0003000000142492354!):RMS(2)=2.9225#-1.06147003#*Z+0.24543649#*Z^2-0.011595060117542744!*Z^3
1650 Z=FNL(X+0.0010000000474974513!):RMS(3)=2.9243354#-1.0639756#*Z+0.24340839684009552!*Z^2-0.010023670271039009!*Z^3
1660 Z=FNL(X+0.003000000026077032!):RMS(4)=2.92622#-1.06753474#*Z+0.24417227#*Z^2-0.00967117864638567!*Z^3
1670 Z=FNL(X+0.010999999940395355!):RMS(5)=2.9280822#-1.07905097#*Z+0.26040006#*Z^2-0.015341900289058685!*Z^3
1680 Z=FNL(X+0.04699999839067459!):RMS(6)=2.9473#-1.12448149#*Z+0.29143574#*Z^2-0.021735940128564835!*Z^3
1690 Z=FNL(X+0.10000000149011612!):RMS(7)=2.9705544#-1.18540651#*Z+0.34445617#*Z^2-0.03613618016242981!*Z^3
1700 Z=FNL(X+0.25999999046325684!):RMS(8)=3.03314045#-1.2905979300000001#*Z+0.3977716863155365!*Z^2-0.04408657178282738!*Z^3
1710 Z=FNL(X+0.44999998807907104!):RMS(9)=3.102199#-1.42272951#*Z+0.48406043#*Z^2-0.06289243698120117!*Z^3
1720 Z=FNL(X+0.9100000262260437!):RMS(10)=3.24022223#-1.63958133#*Z+0.5933840274810791!*Z^2-0.08045025914907455!*Z^3
1730 Z=FNL(X+3.4000000953674316!):RMS(11)=3.9886191#-2.84066747#*Z+1.24321336#*Z^2-0.1984214037656784!*Z^3
1740 Z=FNL(X+9):RMS(12)=7.06962391#-7.94806406#*Z+4.08800282#*Z^2-0.72809091#*Z^3
1750 Z=FNL(X+1.600000023841858!):RMS(13)=2.26302751#+0.12796384#*Z-0.47696645#*Z^2+0.13469729#*Z^3
1760 Z=FNL(X+3.200000047683716!):RMS(14)=2.06929292#+0.39970554#*Z-0.59952882#*Z^2+0.15200733#*Z^3
1770 Z=FNL(X+6.5!):RMS(15)=1.7517035#+0.73609232#*Z-0.6934189200401306!*Z^2+0.15407527#*Z^3
1780 RMS(16)=1.7660000324249268!-0.001129999989643693!*X
1790 RMS(17)=1.6929999589920044!-0.000590000010561198!*X
1800 RMS(18)=1.6239999532699585!-0.0001900000061141327!*X
1810 RMS(19)=1.6050000190734863!-9.500000305706635e-05!*X
1820 RMS(20)=1.5859999656677246!
1830 RMS(21)=1.5779999494552612!
1840 :REM'..........halfwave PK
1850 Z=FNL(X-0.003800000064074993!):PK(1)=10.6619958#-7.83554594#*Z+3.23636003#*Z^2-0.5464056134223938!*Z^3
1860 Z=FNL(X-0.003100000089034438!):PK(2)=10.64741#-7.8323640900000004#*Z+3.28251602#*Z^2-0.57023492#*Z^3
1870 Z=FNL(X-0.0020000000949949026!):PK(3)=10.655178#-7.8561665099999995#*Z+3.28773251#*Z^2-0.56891549#*Z^3
1880 Z=FNL(X-0.0005000000237487257!):PK(4)=10.656937#-7.8685173200000005#*Z+3.3146588#*Z^2-0.57831414#*Z^3
1890 Z=FNL(X+0.003000000026077032!):PK(5)=10.686702#-7.92298823#*Z+3.31279141#*Z^2-0.56558118#*Z^3
1900 Z=FNL(X+0.024000000208616257!):PK(6)=10.75012574#-8.14507696#*Z+3.5329658#*Z^2-0.6289553046226501!*Z^3
1910 Z=FNL(X+0.04399999976158142!):PK(7)=10.845865#-8.22812998#*Z+3.44375323#*Z^2-0.57158955#*Z^3
1920 Z=FNL(X+0.11800000071525574!):PK(8)=11.005221#-8.43408126#*Z+3.48426737#*Z^2-0.55905724#*Z^3
1930 Z=FNL(X+0.19200000166893005!):PK(9)=11.110157319999999#-8.56045058#*Z+3.50823592#*Z^2-0.5520325899124146!*Z^3
1940 Z=FNL(X+0.3540000021457672!):PK(10)=11.20257#-8.42410769#*Z+3.19592644#*Z^2-0.43939448999999997#*Z^3
1950 Z=FNL(X+1.2899999618530273!):PK(11)=11.99888#-9.67026931#*Z+3.86560587#*Z^2-0.56250568#*Z^3
1960 Z=FNL(X+2.619999885559082!):PK(12)=12.9885#-11.081684599999999#*Z+4.52656886#*Z^2-0.66328951#*Z^3
1970 Z=FNL(X+0.9800000190734863!):PK(13)=6.664899#-0.049108609557151794!*Z-1.98797875#*Z^2+0.62487759#*Z^3
1980 Z=FNL(X+1.899999976158142!):PK(14)=5.3885480999999995#+1.70647934#*Z-2.76251276#*Z^2+0.73125137#*Z^3
1990 Z=FNL(X+7.699999809265137!):PK(15)=1.41507903#+8.0615293#*Z-6.1257894#*Z^2+1.31840197#*Z^3
2000 PK(16)=3.7219998836517334!-0.002739999908953905!*X
2010 PK(17)=3.4739999771118164!-0.0011399999493733048!*X
2020 PK(18)=3.2739999294281006!-0.00031999999191612005!*X
2030 PK(19)=3.2304999828338623!-0.00019999999494757503!*X
2040 PK(20)=3.187000036239624!-7.999999797903001e-05!*X
2050 PK(21)=3.1630001068115234! :RETURN
2060 :REM'..........fullwave VR
2070 Z=FNL(X+0.8999999761581421!):VR(1)=97.8856791#-18.8930079#*Z+8.14641406#*Z^2-15.2964524#*Z^3+3.94739144#*Z^4
2080 Z=FNL(X+0.6499999761581421!):VR(2)=96.04341399#-14.1486108#*Z+1.92259323#*Z^2-11.5737138#*Z^3+3.16014325#*Z^4
2090 Z=FNL(X+0.5799999833106995!):VR(3)=95.5931299#-12.9558161#*Z+0.17746724#*Z^2-10.4378026#*Z^3+2.9058365999999998#*Z^4
2100 Z=FNL(X+0.699999988079071!):VR(4)=96.34010626#-14.7089534#*Z+2.50779064#*Z^2-11.88655#*Z^3+3.2223259300000002#*Z^4
2110 Z=FNL(X+1):VR(5)=98.52365089#-19.8364104#*Z+8.7047288#*Z^2-15.4218043#*Z^3+3.94045611#*Z^4
2120 Z=FNL(X+1.7000000476837158!):VR(6)=104.609515#-32.7898395#*Z+21.79729749#*Z^2-21.8256152#*Z^3+5.12547648#*Z^4
2130 Z=FNL(X+2.5!):VR(7)=112.9907765#-49.6410281#*Z+36.923786559999996#*Z^2-28.3803443#*Z^3+6.21309408#*Z^4
2140 Z=1/(X+22):VR(8)=7.075635#+3792.070321#*Z-79105.89552#*Z^2+853686.6787#*Z^3
2150 Z=FNL(X+1.7999999523162842!):VR(9)=96.95116#-1.42292696#*Z-22.17398177#*Z^2+3.5197825099999998#*Z^3
2160 Z=FNL(X+1.2699999809265137!):VR(10)=93.41236114501953!+1.76619621#*Z-22.6578412#*Z^2+3.38885241#*Z^3
2170 Z=FNL(X+2.490000009536743!):VR(11)=84.9915#+25.1296702#*Z-40.5519735#*Z^2+7.58925655#*Z^3
2180 Z=FNL(X+3.700000047683716!):VR(12)=74.78260040283203!+48.21856246#*Z-56.0749864#*Z^2+10.88160266#*Z^3
2190 Z=FNL(X+7.400000095367432!):VR(13)=42.06813049316406!+113.496642#*Z-95.9676733#*Z^2+18.67842214#*Z^3
2200 Z=FNL(X+11):VR(14)=11.699801#+170.188957#*Z-128.62028#*Z^2+24.70717028#*Z^3
2210 Z=FNL(X+16.799999237060547!):VR(15)=-23.760000228881836!+228.6102602#*Z-158.221511#*Z^2+29.46312459#*Z^3
2220 VR(16)=67.16227732#-0.66734804#*X+0.004905050154775381!*X^2-1.7079999452107586e-05!*X^3
2230 VR(17)=65.31708459000001#-0.6427090764045715!*X+0.004871460143476725!*X^2-1.7700000171316788e-05!*X^3
2240 VR(18)=63.77794701#-0.62446427#*X+0.004842190071940422!*X^2-1.8060000002151355e-05!*X^3
2250 VR(20)=63.10924899#-0.6169983148574829!*X+0.0048260497860610485!*X^2-1.8160000763600692e-05!*X^3
2260 VR(19)=0.5849999785423279!*VR(18)+0.41499999165534973!*VR(20)
2270 VR(21)=62.92453323#-0.61496179#*X+0.0048206099309027195!*X^2-1.818000055209268e-05!*X^3
2280 :REM'......fullwave RF
2290 Z=FNL(X+0.019999999552965164!):RF(1)=0.245226#-0.05190053954720497!*Z-0.011145840398967266!*Z^2+0.0010267499601468444!*Z^3
2300 Z=FNL(X+0.009999999776482582!):RF(2)=0.35005611181259155!-0.07349365204572678!*Z-0.016409749165177345!*Z^2+0.0015392099739983678!*Z^3
2310 Z=FNL(X+0.04399999976158142!):RF(3)=0.6153061#-0.13457019#*Z-0.02738944999873638!*Z^2+0.00336043001152575!*Z^3
2320 Z=FNL(X+0.039000000804662704!):RF(4)=0.82012573#-0.17858999967575073!*Z-0.03782831132411957!*Z^2+0.004928890150040388!*Z^3
2330 Z=FNL(X+0.039000000804662704!):RF(5)=1.230846#-0.26735066#*Z-0.058814629912376404!*Z^2+0.008305509574711323!*Z^3
2340 Z=FNL(X+0.06300000101327896!):RF(6)=2.4713791#-0.53928125#*Z-0.13259252#*Z^2+0.024489810690283775!*Z^3
2350 Z=FNL(X+0.08799999952316284!):RF(7)=3.5349493#-0.76344628#*Z-0.20614451#*Z^2+0.04135192930698395!*Z^3
2360 Z=FNL(X+0.17000000178813934!):RF(8)=6.22762266#-1.30910784#*Z-0.47840873#*Z^2+0.12115686#*Z^3
2370 Z=FNL(X+0.20000000298023224!):RF(9)=8.28609469#-1.64459755#*Z-0.7557321190834045!*Z^2+0.19810906#*Z^3
2380 Z=FNL(X+0.3199999928474426!):RF(10)=12.369897#-2.15288426#*Z-1.47677594#*Z^2+0.39919907#*Z^3
2390 Z=FNL(X+0.7099999785423279!):RF(11)=23.78245#-1.88386587#*Z-4.87321249#*Z^2+1.27318341#*Z^3
2400 Z=FNL(X+1.2799999713897705!):RF(12)=32.3005761#+0.9829102158546448!*Z-9.55894568#*Z^2+2.40711404#*Z^3
2410 Z=FNL(X+3.5!):RF(13)=45.481719970703125!+22.59380371#*Z-29.7846569#*Z^2+6.88254744#*Z^3
2420 Z=FNL(X+5.400000095367432!):RF(14)=46.9213981628418!+50.78556011#*Z-50.2484307#*Z^2+10.954368689999999#*Z^3
2430 Z=FNL(X+10.399999618530273!):RF(15)=25.549999237060547!+136.9689594#*Z-103.574474#*Z^2+20.78253972#*Z^3
2440 RF(16)=111.0214352#-0.34866675#*X+0.00039234000723809004!*X^2+5.9899998632317875e-06!*X^3
2450 RF(17)=124.2645354#-0.25371063#*X+0.00031880001188255847!*X^2+2.9299999368959107e-06!*X^3
2460 RF(18)=138.9624598#-0.14937885#*X+0.0003828899934887886!*X^2+6.999999868639861e-08!*X^3
2470 RF(19)=143.9745819#-0.11063968#*X+0.0003007200139109045!*X^2
2480 RF(20)=148.9263016#-0.07169671356678009!*X+0.00020419999782461673!*X^2
2490 RF(21)=153.73300170898438!-0.02336999960243702!*X
2500 :REM'.........fullwave RMS
2510 Z=FNL(X-0.000699999975040555!):RMS(1)=2.3066539764404297!-0.85600044#*Z+0.18801589#*Z^2-0.012344210408627987!*Z^3
2520 Z=FNL(X-0.0006009999779053032!):RMS(2)=2.307420015335083!-0.85660273#*Z+0.18640929460525513!*Z^2-0.011407109908759594!*Z^3
2530 Z=FNL(X):RMS(3)=2.3093433#-0.85854566#*Z+0.18368474#*Z^2-0.009644920006394386!*Z^3
2540 Z=FNL(X+0.0010000000474974513!):RMS(4)=2.3101587#-0.85965213#*Z+0.18292348#*Z^2-0.00902308989316225!*Z^3
2550 Z=FNL(X+0.006000000052154064!):RMS(5)=2.3108367#-0.86509564#*Z+0.19166979#*Z^2-0.012261552#*Z^3
2560 Z=FNL(X+0.028999999165534973!):RMS(6)=2.32051318#-0.8906316161155701!*Z+0.20920564#*Z^2-0.01569782942533493!*Z^3
2570 Z=FNL(X+0.05999999865889549!):RMS(7)=2.3323102000000002#-0.9180709499999999#*Z+0.22942897#*Z^2-0.0204128697514534!*Z^3
2580 Z=FNL(X+0.1679999977350235!):RMS(8)=2.368331#-0.98450197#*Z+0.26803003999999997#*Z^2-0.027539189904928207!*Z^3
2590 Z=FNL(X+0.3400000035762787!):RMS(9)=2.438103#-1.13811696#*Z+0.38099092#*Z^2-0.054482780396938324!*Z^3
2600 Z=FNL(X+0.6100000143051147!):RMS(10)=2.489124059677124!-1.19969261#*Z+0.39822569#*Z^2-0.053933680057525635!*Z^3
2610 Z=FNL(X+2.200000047683716!):RMS(11)=2.85321626#-1.7716025499999999#*Z+0.69708088#*Z^2-0.10560470074415207!*Z^3
2620 Z=FNL(X+4.900000095367432!):RMS(12)=3.6665749549865723!-3.11711789#*Z+1.45174376#*Z^2-0.24797881#*Z^3
2630 Z=FNL(X+15):RMS(13)=6.7043499#-7.55433972#*Z+3.61930516#*Z^2-0.60090774#*Z^3
2640 Z=FNL(X+2.299999952316284!):RMS(14)=1.69602495#+0.20847374#*Z-0.4534376859664917!*Z^2+0.11849511#*Z^3
2650 Z=FNL(X+5.199999809265137!):RMS(15)=1.4286577#+0.5010564923286438!*Z-0.54278533#*Z^2+0.12270929#*Z^3
2660 RMS(16)=1.32803833#-0.002065039938315749!*X+8.560001333535183e-06!*X^2
2670 RMS(17)=1.246999979019165!-0.0006300000241026282!*X
2680 RMS(18)=1.1679999828338623!-0.0001900000061141327!*X
2690 RMS(19)=1.1469999551773071!-0.00011000000085914508!*X
2700 RMS(20)=1.128999948501587!-3.9999998989515007e-05!*X
2710 RMS(21)=1.1169999837875366!
2720 :REM'......fullwave PK
2730 Z=FNL(X-0.003700000001117587!):PK(1)=6.632169#-4.99189284#*Z+2.03918808#*Z^2-0.35866144#*Z^3
2740 Z=FNL(X-0.003599999938160181!):PK(2)=6.635314#-4.99558552#*Z+2.03427016#*Z^2-0.35534947#*Z^3
2750 Z=FNL(X-0.0027000000700354576!):PK(3)=6.63760452#-5.00380956#*Z+2.04258488#*Z^2-0.3577769100666046!*Z^3
2760 Z=FNL(X-0.0027000000700354576!):PK(4)=6.647841#-5.01392812#*Z+2.02583001#*Z^2-0.34720808999999997#*Z^3
2770 Z=FNL(X):PK(5)=6.65986883#-5.03514604#*Z+2.02624014#*Z^2-0.34296394#*Z^3
2780 Z=FNL(X+0.013000000268220901!):PK(6)=6.68748716#-5.12370005#*Z+2.1043519973754883!*Z^2-0.36330853#*Z^3
2790 Z=FNL(X+0.028999999165534973!):PK(7)=6.7097387#-5.19977154#*Z+2.18942197#*Z^2-0.39048149#*Z^3
2800 Z=FNL(X+0.07999999821186066!):PK(8)=6.81255922#-5.3306027799999995#*Z+2.18332004#*Z^2-0.36523405#*Z^3
2810 Z=FNL(X+0.12999999523162842!):PK(9)=6.8704217#-5.39357307#*Z+2.18362508#*Z^2-0.35641512#*Z^3
2820 Z=FNL(X+0.23800000548362732!):PK(10)=6.923733#-5.32709932#*Z+2.00854247#*Z^2-0.29056714#*Z^3
2830 Z=FNL(X+0.7699999809265137!):PK(11)=7.1105533#-5.4969513800000005#*Z+2.01127839#*Z^2-0.27266624#*Z^3
2840 Z=FNL(X+1.4199999570846558!):PK(12)=7.232876#-5.60243056#*Z+2.01579355#*Z^2-0.26382088#*Z^3
2850 Z=FNL(X+4.400000095367432!):PK(13)=8.1859534#-6.98431505#*Z+2.69320544#*Z^2-0.37617526#*Z^3
2860 Z=FNL(X+9.699999809265137!):PK(14)=11.0631207#-11.2019694#*Z+4.7775519#*Z^2-0.72271754#*Z^3
2870 Z=FNL(X+2.940000057220459!):PK(15)=2.740003#+1.37287757#*Z-1.70865419#*Z^2+0.41114381#*Z^3
2880 PK(16)=2.0940001010894775!-0.002589999930933118!*X
2890 PK(17)=1.8559999465942383!-0.0009800000116229057!*X
2900 PK(18)=1.6759999990463257!-0.0002300000051036477!*X
2910 PK(19)=1.6339999437332153!-0.00013000000035390258!*X
2920 PK(20)=1.6030000448226929!-5.999999848427251e-05!*X
2930 PK(21)=1.5839999914169312! :RETURN
2940 :REM'........floating doubler
2950 Z=FNL(X+0.1599999964237213!):VR(1)=172.1445579#-43.792675700000004#*Z-24.2593488#*Z^2-6.62190942#*Z^3+5.68802877#*Z^4
2960 Z=FNL(X+0.1599999964237213!):VR(2)=172.1507568#-43.7876267#*Z-24.4047688#*Z^2-6.45068647#*Z^3+5.63736554#*Z^4
2970 Z=FNL(X+0.20999999344348907!):VR(3)=173.0467506#-44.975372899999996#*Z-23.5645057#*Z^2-6.89100488#*Z^3+5.7410441599999995#*Z^4
2980 Z=FNL(X+0.30000001192092896!):VR(4)=174.7970823#-47.4511813#*Z-21.9434353#*Z^2-7.54367307#*Z^3+5.86340631#*Z^4
2990 Z=FNL(X+0.550000011920929!):VR(5)=180.2222887#-54.9621211#*Z-18.5176866#*Z^2-7.82550075#*Z^3+5.7486339300000004#*Z^4
3000 Z=1/(X+8):VR(6)=3.6067561#+2543.176192#*Z-17843.179799999998#*Z^2+74745.88774#*Z^3
3010 Z=1/(X+10):VR(7)=2.189483#+2743.1842616#*Z-20432.7252#*Z^2+112706.2207#*Z^3
3020 Z=FNL(X+0.7099999785423279!):VR(8)=172.96251#-23.4333826#*Z-64.499041#*Z^2+19.67076677#*Z^3
3030 Z=FNL(X+0.800000011920929!):VR(9)=168.25165#-12.4826165#*Z-71.6765557#*Z^2+21.10976485#*Z^3
3040 Z=FNL(X+1.2000000476837158!):VR(10)=157.58599853515625!+17.16050442#*Z-95.9313826#*Z^2+27.19674911#*Z^3
3050 Z=FNL(X+2.5!):VR(11)=117.09100341796875!+99.68175703#*Z-148.160681#*Z^2+37.78589111#*Z^3
3060 Z=FNL(X+4.199999809265137!):VR(12)=74.55699920654297!+179.8888733#*Z-194.697546#*Z^2+46.31292236#*Z^3
3070 Z=FNL(X+8.699999809265137!):VR(13)=-36.08599853515625!+365.79830549999997#*Z-294.935808#*Z^2+63.87622604#*Z^3
3080 Z=FNL(X+12.5!):VR(14)=-118.0999984741211!+490.0007236#*Z-354.662702#*Z^2+73.02120389#*Z^3
3090 Z=FNL(X+20.399999618530273!):VR(15)=-274+709.6412031#*Z-452.716272#*Z^2+86.81186732#*Z^3
3100 VR(16)=49.55613787#-0.29106934#*X-0.001410829951055348!*X^2+1.6739999409765005e-05!*X^3
3110 VR(17)=38.30307835#-0.13799376#*X-0.0014253900153562427!*X^2+1.1209999684069771e-05!*X^3
3120 VR(18)=23.90809027#-0.03355557098984718!*X-0.0006056400015950203!*X^2+3.0399999104702147e-06!*X^3
3130 VR(20)=12.44720491#-0.0005709470133297145!*X-6.754000060027465e-05!*X^2
3140 VR(19)=0.5849999785423279!*VR(18)+0.41499999165534973!*VR(20)
3150 VR(21)=6.291999816894531!-0.0018100000452250242!*X
3160 :REM'..........floating doubler RF
3170 Z=FNL(X+0.05000000074505806!):RF(1)=0.42266715#-0.14875655#*Z-0.012772819958627224!*Z^2+0.01063000038266182!*Z^3
3180 RF(2)=0.60421011#-0.21272715#*Z-0.01916779950261116!*Z^2+0.01566426083445549!*Z^3
3190 Z=FNL(X+0.0430000014603138!):RF(3)=1.0558680295944214!-0.36848702#*Z-0.03721215948462486!*Z^2+0.028557930141687393!*Z^3
3200 Z=FNL(X+0.04699999839067459!):RF(4)=1.4020839929580688!-0.49542575#*Z-0.047483671456575394!*Z^2+0.03916987031698227!*Z^3
3210 Z=FNL(X+0.05999999865889549!):RF(5)=2.1222479343414307!-0.743948528#*Z-0.08864548802375793!*Z^2+0.06518165022134781!*Z^3
3220 Z=FNL(X+0.10000000149011612!):RF(6)=4.27725113#-1.48028214#*Z-0.25701777#*Z^2+0.16574412#*Z^3
3230 RF(7)=6.09313782#-2.02119328#*Z-0.48001157#*Z^2+0.27282839#*Z^3
3240 Z=FNL(X+0.14000000059604645!):RF(8)=10.5768478#-3.16608901#*Z-1.24016452#*Z^2+0.59750437#*Z^3
3250 Z=FNL(X+0.20999999344348907!):RF(9)=14.00349006#-3.8485537#*Z-2.01237862#*Z^2+0.89591081#*Z^3
3260 Z=FNL(X+0.3400000035762787!):RF(10)=20.489847#-4.50195829#*Z-3.9947064#*Z^2+1.57860449#*Z^3
3270 Z=FNL(X+1):RF(11)=36.9463734#-1.09181413#*Z-13.0280039#*Z^2+4.19174985#*Z^3
3280 Z=1/(X+7):RF(12)=19.57144#+369.5641408#*Z-1426.08842#*Z^2+1494.840519#*Z^3
3290 Z=1/(X+7.5!):RF(13)=33.05641174316406!+674.8041089#*Z-4667.30987#*Z^2+11742.48497#*Z^3
3300 Z=1/(X+10):RF(14)=42.52904#+936.9880294#*Z-8405.178390000001#*Z^2+27346.51088#*Z^3
3310 RF(15)=96.35491027#-0.6019528199999999#*X+0.004773229826241732!*X^2-1.3660000149684492e-05!*X^3
3320 RF(16)=122.2926884#-0.29209117#*X+0.0019221099792048335!*X^2-5.280000095808646e-06!*X^3
3330 RF(17)=132.9808582#-0.21648304000000002#*X+0.0017679700395092368!*X^2-6.629999916185625e-06!*X^3
3340 RF(18)=145.4517871#-0.14460357000000001#*X+0.001315849949605763!*X^2-5.289999990054639e-06!*X^3
3350 RF(20)=154.3506174#-0.06890148669481277!*X+0.0003725200076587498!*X^2-8.600000001024455e-07!*X^3
3360 RF(19)=0.5849999785423279!*RF(18)+0.41499999165534973!*RF(20)
3370 RF(21)=157.75900268554688!-0.014379999600350857!*X
3380 :REM'............floating doubler RMS
3390 Z=FNL(X-9.999999747378752e-05!):RMS(1)=3.7133#-1.2979760599999999#*Z+0.32996938#*Z^2-0.014861609786748886!*Z^3
3400 Z=FNL(X):RMS(2)=3.71561125#-1.29941435#*Z+0.324851998#*Z^2-0.012002849951386452!*Z^3
3410 Z=FNL(X+0.003000000026077032!):RMS(3)=3.7174050100000002#-1.30495474#*Z+0.32919317#*Z^2-0.012981199659407139!*Z^3
3420 Z=FNL(X+0.008009999990463257!):RMS(4)=3.7170000076293945!-1.31374298#*Z+0.34609072#*Z^2-0.019513919949531555!*Z^3
3430 Z=FNL(X+0.01899999938905239!):RMS(5)=3.7249860763549805!-1.3348372099999999#*Z+0.36125069856643677!*Z^2-0.022660499438643456!*Z^3
3440 Z=FNL(X+0.07800000160932541!):RMS(6)=3.7597848#-1.42487145#*Z+0.43365609645843506!*Z^2-0.040761809796094894!*Z^3
3450 Z=FNL(X+0.17000000178813934!):RMS(7)=3.81172#-1.56931666#*Z+0.5636800399999999#*Z^2-0.07669670879840851!*Z^3
3460 Z=FNL(X+0.38999998569488525!):RMS(8)=3.904341#-1.6892697700000001#*Z+0.5921330499999999#*Z^2-0.07185745984315872!*Z^3
3470 Z=FNL(X+0.6899999976158142!):RMS(9)=4.04164885#-1.95719833#*Z+0.76853092#*Z^2-0.11035663#*Z^3
3480 Z=FNL(X+1.6299999952316284!):RMS(10)=4.5252669#-2.89132796#*Z+1.37588988#*Z^2-0.2412882000207901!*Z^3
3490 Z=1/(X+4):RMS(11)=2.25720719#+7.06080355#*Z-11.7327783#*Z^2+6.25783602#*Z^3
3500 Z=1/(X+5):RMS(12)=2.2275795#+8.13517442#*Z-20.9821087#*Z^2+14.46275679#*Z^3
3510 Z=1/(X+7):RMS(13)=2.23225461#+8.8643119#*Z-47.1868832#*Z^2+90.67954083000001#*Z^3
3520 Z=1/(X+8):RMS(14)=2.22965685#+8.8238458#*Z-65.2012789#*Z^2+175.9211298#*Z^3
3530 Z=1/(X+12):RMS(15)=2.227536#+8.35385599#*Z-90.8835468#*Z^2+340.8062544#*Z^3
3540 RMS(16)=2.32087529#-0.0005388500285334885!*X
3550 RMS(17)=2.2730000019073486!-0.00022000000171829015!*X
3560 RMS(18)=2.24399995803833!-7.000000186963007e-05!*X
3570 RMS(20)=2.236999988555908!-3.9999998989515007e-05!*X
3580 RMS(19)=0.5849999785423279!*RMS(18)+0.41499999165534973!*RMS(20)
3590 RMS(21)=RMS(20)
3600 :REM'.........floating doubler PK
3610 Z=FNL(X-0.0031999999191612005!):PK(1)=8.613445#-6.0965849500000004#*Z+2.61792484#*Z^2-0.44006208#*Z^3
3620 Z=FNL(X-0.0031999999191612005!):PK(2)=8.619954700000001#-6.1043201#*Z+2.60924375#*Z^2-0.43401978#*Z^3
3630 Z=FNL(X-0.00139999995008111!):PK(3)=8.626281#-6.1224856800000005#*Z+2.62011312#*Z^2-0.43544341#*Z^3
3640 Z=FNL(X):PK(4)=8.6518297#-6.14885228#*Z+2.58176963#*Z^2-0.41065554#*Z^3
3650 Z=FNL(X+0.007000000216066837!):PK(5)=8.64961677#-6.20251193#*Z+2.69086655#*Z^2-0.4536009132862091!*Z^3
3660 Z=FNL(X+0.03799999877810478!):PK(6)=8.722540200000001#-6.42229583#*Z+2.89168132#*Z^2-0.50887234#*Z^3
3670 Z=FNL(X+0.0689999982714653!):PK(7)=8.8051035#-6.50285956#*Z+2.8471237#*Z^2-0.474467788#*Z^3
3680 Z=FNL(X+0.1899999976158142!):PK(8)=8.99369754#-6.85036955#*Z+3.05515378#*Z^2-0.51514236#*Z^3
3690 Z=FNL(X+0.30000001192092896!):PK(9)=9.10030848#-6.92243292#*Z+2.99611187#*Z^2-0.47965322#*Z^3
3700 Z=FNL(X+0.5899999737739563!):PK(10)=9.2975526#-7.09011082#*Z+2.95947498#*Z^2-0.44304989#*Z^3
3710 Z=1/(X+7.900000095367432!):PK(11)=3.159053#+27.4096663#*Z-101.356178#*Z^2+1339.457724#*Z^3
3720 Z=1/(X+3.5!):PK(12)=3.223444938659668!+20.51637041#*Z-40.2630366#*Z^2+24.17845725#*Z^3
3730 Z=1/(X+4.199999809265137!):PK(13)=3.1935479640960693!+21.74921647#*Z-99.7897404#*Z^2+150.4303268#*Z^3
3740 Z=1/(X+5.800000190734863!):PK(14)=3.168471#+23.03090415#*Z-163.645698#*Z^2+377.071706#*Z^3
3750 Z=1/(X+11.100000381469727!):PK(15)=3.1382100582122803!+24.84082669#*Z-345.89070300000003#*Z^2+1533.729541#*Z^3
3760 Z=1/(X+24):PK(16)=3.1504849999999998#+15.49889415#*Z-520.259934#*Z^2+5323.704781#*Z^3
3770 PK(17)=3.2037912#+0.0008066999725997448!*X-1.5069999790284783e-05!*X^2+6.999999868639861e-08!*X^3
3780 PK(18)=3.1710000038146973!
3790 PK(19)=3.1689999103546143!
3800 PK(20)=3.1670000553131104!
3810 PK(21)=PK(20) :RETURN
3820 :REM'.......grounded doubler VR
3830 Z=FNL(X+0.16599999368190765!):VR(1)=172.2468159#-43.9074456#*Z-24.2021624#*Z^2-6.53462367#*Z^3+5.66036921#*Z^4
3840 Z=FNL(X+0.20000000298023224!):VR(2)=172.8486494#-44.7133026#*Z-23.679706#*Z^2-6.88657476#*Z^3+5.7460355100000005#*Z^4
3850 Z=FNL(X+0.30000001192092896!):VR(3)=174.7150431#-47.6360898#*Z-23.2740995#*Z^2-5.64386918#*Z^3+5.27138509#*Z^4
3860 Z=FNL(X+0.4399999976158142!):VR(4)=177.5476142#-50.5244752#*Z-21.8795636#*Z^2-6.44267335#*Z^3+5.50876866#*Z^4
3870 Z=FNL(X+1):VR(5)=190.5350199#-66.9947964#*Z-17.2280822#*Z^2-4.64776504#*Z^3+4.69872566#*Z^4
3880 Z=FNL(X+0.8799999952316284!):VR(6)=180.8347#-36.7659637#*Z-56.7039172#*Z^2+18.12620533#*Z^3
3890 Z=FNL(X+0.7300000190734863!):VR(7)=173.837996#-25.8517382#*Z-62.489874900000004#*Z^2+19.158595#*Z^3
3900 Z=FNL(X+0.9700000286102295!):VR(8)=162.55890399999998#+0.92327181#*Z-82.2921002#*Z^2+23.7916436#*Z^3
3910 Z=FNL(X+1.2599999904632568!):VR(9)=152.13800048828125!+24.03915101#*Z-98.3263756#*Z^2+27.34959694#*Z^3
3920 Z=FNL(X+2.200000047683716!):VR(10)=124.43#+85.51896637#*Z-140.233411#*Z^2+36.42141512#*Z^3
3930 Z=FNL(X+5):VR(11)=32.05245#+239.7440485#*Z-223.105466#*Z^2+50.87378678#*Z^3
3940 Z=FNL(X+8):VR(12)=-53.90098190307617!+369.3585917#*Z-285.918707#*Z^2+60.66257529#*Z^3
3950 Z=FNL(X+20):VR(13)=-390.8280029296875!+877.4114732#*Z-535.468461#*Z^2+100.7478583#*Z^3
3960 Z=FNL(X+28):VR(14)=-555.1229858398438!+1073.426523#*Z-606.916565#*Z^2+108.1066584#*Z^3
3970 Z=FNL(X+65):VR(15)=-2154.919921875!+3284.468879#*Z-1613.81282#*Z^2+259.4408811#*Z^3
3980 VR(16)=24.61015494#-0.02793590910732746!*X-0.0009519099839963019!*X^2+5.160000000614673e-06!*X^3
3990 VR(17)=18.56896931#-0.015593449585139751!*X-0.00037438998697325587!*X^2+1.5199999552351073e-06!*X^3
4000 VR(18)=11.60350176#-0.006094209849834442!*X-5.5789998441468924e-05!*X^2
4010 VR(20)=6.145999908447266!-0.002090000081807375!*X
4020 VR(19)=0.5849999785423279!*VR(18)+0.41499999165534973!*VR(20)
4030 VR(21)=3.134999990463257!-0.0003100000030826777!*X
4040 :REM'.......grounded doubler RF
4050 Z=FNL(X+0.05000000074505806!):RF(1)=0.5221288#-0.08044873178005219!*Z-0.010174477#*Z^2+0.0055801598355174065!*Z^3
4060 Z=FNL(X+0.05999999865889549!):RF(2)=0.74678156#-0.11692145#*Z-0.015063310042023659!*Z^2+0.00872108992189169!*Z^3
4070 Z=FNL(X+0.07999999821186066!):RF(3)=1.309874#-0.20610965#*Z-0.02953040972352028!*Z^2+0.016887130215764046!*Z^3
4080 Z=FNL(X+0.09009999781847!):RF(4)=1.75!-0.27402093#*Z-0.04500935971736908!*Z^2+0.025055350735783577!*Z^3
4090 Z=FNL(X+0.10000000149011612!):RF(5)=2.6238744#-0.40171521#*Z-0.08545701950788498!*Z^2+0.04424671083688736!*Z^3
4100 Z=FNL(X+0.17000000178813934!):RF(6)=5.25095069#-0.73962659#*Z-0.27240238#*Z^2+0.12392061#*Z^3
4110 Z=FNL(X+0.2199999988079071!):RF(7)=7.4668521#-0.94941273#*Z-0.48464611172676086!*Z^2+0.20248633#*Z^3
4120 Z=FNL(X+0.44999998807907104!):RF(8)=12.869831#-1.19406425#*Z-1.18818104#*Z^2+0.43178223#*Z^3
4130 Z=FNL(X+0.6000000238418579!):RF(9)=16.90163719#-1.02028618#*Z-2.00632064#*Z^2+0.67612155#*Z^3
4140 Z=FNL(X+1.399999976158142!):RF(10)=24.4869543#+0.41213571#*Z-4.3790858#*Z^2+1.32003203#*Z^3
4150 Z=FNL(X+5):RF(11)=41.7527129#+12.6191932#*Z-15.0207961#*Z^2+3.70048547#*Z^3
4160 Z=FNL(X+15):RF(12)=45.317898#+43.7587751#*Z-35.9411141#*Z^2+7.85868346#*Z^3
4170 Z=FNL(X+0.5!):RF(13)=93.10781717#-0.59542104#*Z+0.43900731205940247!*Z^2-0.76399998#*Z^3
4180 Z=FNL(X+10):RF(14)=142.1328#-56.6186104#*Z+38.88940855#*Z^2-8.91754463#*Z^3
4190 Z=FNL(X+9):RF(15)=186.67466#-74.2834542#*Z+49.62241911#*Z^2-10.2092923#*Z^3
4200 Z=FNL(X+4):RF(16)=215.36921999999998#+13.10550058#*Z-16.6059779#*Z^2+6.26451334#*Z^3
4210 RF(17)=247.1134812#-0.09361825883388519!*X+0.002108240034431219!*X^2-7.720000212430023e-06!*X^3
4220 RF(18)=279.1230885#-0.07056038081645966!*X+0.0006895699771121144!*X^2-1.3200000239521614e-06!*X^3
4230 RF(20)=302.8617939#-0.04377961903810501!*X+0.00011362999794073403!*X^2+9.000000034120603e-08!*X^3
4240 RF(19)=0.5849999785423279!*RF(18)+0.41499999165534973!*RF(20)
4250 RF(21)=312.83599853515625!-0.014089999720454216!*X
4260 :REM'.......grounded doubler RMS
4270 Z=FNL(X+0.0010000000474974513!):RMS(1)=3.7136#-1.2997099300000001#*Z+0.33218116#*Z^2-0.015583709813654423!*Z^3
4280 Z=FNL(X+0.003000000026077032!):RMS(2)=3.71443#-1.30369804#*Z+0.33665639#*Z^2-0.016948670148849487!*Z^3
4290 Z=FNL(X+0.009999999776482582!):RMS(3)=3.7188607#-1.3161216#*Z+0.34578056#*Z^2-0.018887460231781006!*Z^3
4300 Z=FNL(X+0.017000000923871994!):RMS(4)=3.7240560054779053!-1.32643916#*Z+0.35034648#*Z^2-0.019122779369354248!*Z^3
4310 Z=FNL(X+0.039000000804662704!):RMS(5)=3.7333#-1.35768005#*Z+0.38350318#*Z^2-0.029296750202775!*Z^3
4320 Z=FNL(X+0.12600000202655792!):RMS(6)=3.77435#-1.43751859#*Z+0.43246832#*Z^2-0.03881562128663063!*Z^3
4330 Z=FNL(X+0.23000000417232513!):RMS(7)=3.8143435#-1.5141061#*Z+0.48139962000000003#*Z^2-0.04913216829299927!*Z^3
4340 Z=FNL(X+0.5899999737739563!):RMS(8)=3.93711#-1.73319605#*Z+0.61492798#*Z^2-0.07649500668048859!*Z^3
4350 Z=FNL(X+0.9200000166893005!):RMS(9)=4.0215327#-1.8581323#*Z+0.67371711#*Z^2-0.0851026326417923!*Z^3
4360 Z=FNL(X+1.7999999523162842!):RMS(10)=4.25383543#-2.22969659#*Z+0.8749961256980896!*Z^2-0.12183392#*Z^3
4370 Z=FNL(X+6):RMS(11)=5.47849773#-4.17163282#*Z+1.92028232#*Z^2-0.3117164075374603!*Z^3
4380 Z=FNL(X+10):RMS(12)=6.2696784#-5.23764972#*Z+2.39197137#*Z^2-0.37950141#*Z^3
4390 Z=FNL(X+1.7999999523162842!):RMS(13)=2.7627687#+0.16532277#*Z-0.42109845#*Z^2+0.11338024#*Z^3
4400 Z=FNL(X+3.5!):RMS(14)=2.59750117#+0.38220342#*Z-0.51997443#*Z^2+0.12904963#*Z^3
4410 Z=FNL(X+5):RMS(15)=2.40514504#+0.48571409#*Z-0.4844622015953064!*Z^2+0.10876369#*Z^3
4420 RMS(16)=2.38854913#-0.0017532400088384748!*X+7.260000074893469e-06!*X^2
4430 RMS(17)=2.3320000171661377!-0.0005699999746866524!*X
4440 RMS(18)=2.2739999294281006!-0.00015999999595806003!*X
4450 RMS(20)=2.243000030517578!
4460 RMS(19)=0.5849999785423279!*RMS(18)+0.41499999165534973!*RMS(20)
4470 RMS(21)=2.23799991607666!
4480 :REM'........grounded doubler PK
4490 Z=FNL(X-0.003800000064074993!):PK(1)=8.621852#-6.10027794#*Z+2.59390069#*Z^2-0.42715586#*Z^3
4500 Z=FNL(X-0.00279999990016222!):PK(2)=8.606568#-6.09935133#*Z+2.64626482#*Z^2-0.45358059#*Z^3
4510 Z=FNL(X-0.0008999999845400453!):PK(3)=8.6110946#-6.1229401#*Z+2.67308052#*Z^2-0.46176623#*Z^3
4520 Z=FNL(X):PK(4)=8.65016877#-6.15731639#*Z+2.60261955#*Z^2-0.41919838#*Z^3
4530 Z=FNL(X+0.007000000216066837!):PK(5)=8.6542868#-6.22604695#*Z+2.72240708#*Z^2-0.46445473#*Z^3
4540 Z=FNL(X+0.035999998450279236!):PK(6)=8.7593131#-6.47110856#*Z+2.88888179#*Z^2-0.49881471#*Z^3
4550 Z=FNL(X+0.06801000237464905!):PK(7)=8.86400032043457!-6.62872144#*Z+2.9357420100000002#*Z^2-0.49461771#*Z^3
4560 Z=FNL(X+0.17599999904632568!):PK(8)=9.1132991#-6.97177219#*Z+3.04414759#*Z^2-0.49294287999999997#*Z^3
4570 Z=FNL(X+0.2849999964237213!):PK(9)=9.30988267#-7.22650862#*Z+3.12568933#*Z^2-0.493910014629364!*Z^3
4580 Z=FNL(X+0.5849999785423279!):PK(10)=9.793341#-7.94898585#*Z+3.47462517#*Z^2-0.54774881#*Z^3
4590 Z=FNL(X+2.200000047683716!):PK(11)=12.09898876#-11.4576256#*Z+5.27252517#*Z^2-0.8565583825111389!*Z^3
4600 Z=FNL(X+6):PK(12)=20.441628#-25.3208463#*Z+13.04173754#*Z^2-2.31570598#*Z^3
4610 Z=1/(X+4.900000095367432!):PK(13)=3.142804#+32.421093139999996#*Z-111.540756#*Z^2+109.583293#*Z^3
4620 Z=1/(X+5.599999904632568!):PK(14)=3.122565984725952!+37.65490793#*Z-197.749967#*Z^2+337.5824572#*Z^3
4630 Z=1/(X+7.800000190734863!):PK(15)=3.09699#+47.93314565#*Z-431.455711#*Z^2+1274.699684#*Z^3
4640 Z=1/(X+23):PK(16)=2.8860172#+107.6458971#*Z-3115.1630999999998#*Z^2+29053.57263#*Z^3
4650 PK(17)=3.76839988#+0.004771099891513586!*X-0.0001369700039504096!*X^2+7.099999947968172e-07!*X^3
4660 PK(18)=3.44702779#+0.0019804700277745724!*X-1.576000067871064e-05!*X^2
4670 PK(20)=3.25435229#+0.0004859000036958605!*X
4680 PK(19)=0.5849999785423279!*PK(18)+0.41499999165534973!*PK(20)
4690 PK(21)=3.190000057220459!+0.0001500000071246177!*X :RETURN
4700 Y=Y1+(Y2-Y1)*LOG(X/X1)/LOG(X2/X1) :RETURN
4710 LOCATE 17:PRINT :COLOR 0,7
4720 PRINT "                                      "
4730 PRINT "                   ┌──>├───┬────┬─── +"
4740 PRINT " ───────────)║(────┘ diode │    │     "
4750 PRINT " Vac        )║(            C   RL  Vdc"
4760 PRINT " ───────────)║(────┐       │    │     "
4770 PRINT " transformer─┘     └───────┴────┴─── -"
4780 COLOR 7,0:RETURN 660
4790 LOCATE 17:PRINT:COLOR 0,7
4800 PRINT "                diodes  ┌──┬──┬───── +"
4810 PRINT " ───────────)║(───>├──┬─┘  │  │       "
4820 PRINT " Vac        )║(───────│─┐  C  RL Vdc  "
4830 PRINT " ───────────)║(───>├──┘ │  │  │       "
4840 PRINT " transformer─┘          └──┴──┴───── -"
4850 COLOR 7,0:RETURN 660
4860 LOCATE 17:PRINT:COLOR 0,7
4870 PRINT "               ┌─────┐                "
4880 PRINT " ──────────)║(─┘ ┌>├─┴─>├┐            "
4890 PRINT " Vac       )║(  ┌┤ diodes├─┬──┬───── +"
4900 PRINT " ──────────)║(─┐│└>├─┬─>├┘ │  │       "
4910 PRINT " transformer┘  └│────┘     C  RL Vdc  "
4920 PRINT "                └──────────┴──┴───── -"
4930 COLOR 7,0:RETURN 660
4940 LOCATE 17:PRINT:COLOR 0,7
4950 PRINT "                    diode          "
4960 PRINT " ──────────)║(──┬────>│──┬────┬── + "
4970 PRINT " Vac       )║(  │        C    │     "
4980 PRINT " ──────────)║(──│────────┤    RL Vdc"
4990 PRINT " transformer┘   │  diode C    │     "
5000 PRINT "                └────│<──┴────┴── -"
5010 COLOR 7,0:RETURN 660
5020 LOCATE 17:PRINT:COLOR 0,7
5030 PRINT "                         diode        "
5040 PRINT " ──────────)║(────C+────┬─>│─┬──┬─── +"
5050 PRINT " Vac       )║(          │    │+ │     "
5060 PRINT " ──────────)║(────┬──>├─┘    C  RL Vdc"
5070 PRINT " transformer┘     │ diode    │  │     "
5080 PRINT "                  └──────────┴──┴─── -"
5090 COLOR 7,0:RETURN 660
5100 :REM'
5110 :REM'.....prep display prior to PRT
5120 FOR Z=18 TO 20
5130 LOCATE Z,41:PRINT STRING$(39,32)
5140 NEXT Z
5150 :REM'
5160 :REM'.....PRT
5170 KEY OFF:GOSUB 5240:LOCATE 25,5:COLOR 0,2
5180 PRINT " Send this page to:(1)Printer Queue? (2)Printout? ";
5190 PRINT "(3)Next page? (1/2/3)";:COLOR 7,0
5200 Z$=INKEY$:IF Z$<"1"OR Z$>"3"THEN 5200 :ELSE GOSUB 5240
5210 IF Z$="3"THEN RETURN
5220 FOR I%=1 TO 24:FOR J%=1 TO 80:LPRINT CHR$(SCREEN(I%,J%));:NEXT J%:NEXT I%
5230 IF Z$="2"THEN LPRINT CHR$(12) :ELSE 5170
5240 LOCATE 25,1:PRINT STRING$(80,32);:RETURN
5250 :REM'.........Program description.
5260 :REM'When power supply parameters are normalized, they become functions of
5270 :REM'only a few variables, Thus, Vdc/Vpk, Vpp/Vdc, Irms/Idc, and Ipk/Idc are
5280 :REM'functions of the AC input Vpk, the source resistance to load resistance
5290 :REM'ratio RS/RL, and W*C*RL, where W=2*pi*Freq, C is the filter capacitance
5300 :REM'and RL is the load resistance. This program is based on data taken with
5310 :REM'an accurate time step program. Values of Vdc/Vpk etc were taken for a
5320 :REM'range of RS/RL values for fixed WCRL values. Equations were then generated
5330 :REM'so that, for specific values of WCRL, any RS/RL value gives values for
5340 :REM'Vdc/Vpk, Vpp/Vdc. Irms/Idc, and Ipk/Idc. For other values of WCRL, an
5350 :REM'interpolation routine is used. Given the transformer parameters, the
5360 :REM'frequency, the filter capacitance C and the load RL, fimal values are
5370 :REM'readily calculated. The program covers values of RS/RL from .02% to 100%,
5380 :REM'and WCRL values from .1 to 1000.
